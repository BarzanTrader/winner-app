<!DOCTYPE html>
<html lang="en"> 
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Winner</title>
        <link rel="stylesheet" href="style.css" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js" crossorigin="anonymous"></script>
        <!-- Firebase compat SDK (required for firebase.xxx syntax) -->
        <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
    </head>
    <body>
 
        <div class="container">
            <div class="application">
                <div class="card">
                    <div class="header-section">
                        <h1>Winner</h1>
                    </div>
                    <div class="main-content">EXPENSE TRACKER</div>
                    
                    <!-- Navigation Tabs -->
                    <div class="nav-tabs">
                        <button class="nav-tab active" data-page="home" id="homeTab">
                            <span>Add Expense</span>
                        </button>
                        <button class="nav-tab" data-page="history" id="historyTab">
                            <span>History</span>
                        </button>
                        <button class="nav-tab" data-page="hourly" id="hourlyTab">
                            <span>Hourly Tracker</span>
                        </button>
                        <button class="nav-tab" data-page="stocks" id="stocksTab">
                            <span>Stocks</span>
                        </button>
                        <button class="nav-tab" data-page="mortgage" id="mortgageTab">
                            <span>Mortgage</span>
                        </button>
                    </div>
                    
                    <!-- Page 1: Home (Add Expense) -->
                    <div class="page active" id="homePage">
                        <!-- Dashboard -->
                        <div id="dashboard">
                            <div id="dashboardEmptyState" class="dashboard-empty-state" aria-hidden="false">
                                <p class="dashboard-empty-label">No data yet</p>
                                <p class="dashboard-empty-hint">Add an expense below.</p>
                            </div>
                            <div id="dashboardCards" class="dashboard-cards hidden">
                                <div class="dashboard-card" id="monthlyTotalCard">
                                    <h3>Total This Month</h3>
                                    <p id="MonthlyTotal" class="dashboard-value">Â£0.00</p>
                                </div>
                                <div class="dashboard-card" id="biggestCategoryCard">
                                    <h3>Biggest Category</h3>
                                    <p id="top-category" class="dashboard-value">-</p>
                                </div>
                                <div class="dashboard-card" id="avgExpenseCard">
                                    <h3>Avg Daily Spend</h3>
                                    <p id="average-expense" class="dashboard-value">Â£0.00</p>
                                </div>
                                <div class="dashboard-card" id="dailyBillsCard">
                                    <h3>Daily Bills</h3>
                                    <p id="dailyBillsValue" class="dashboard-value">Â£0.00</p>
                                </div>
                            </div>
                            <div id="todaysBreakdownSection" class="todays-breakdown-section">
                                <h2>Today's Breakdown</h2>
                                <p>You earned today: Â£<span id="breakdownEarnedToday">0.00</span></p>
                                <p>Your daily bills share: Â£<span id="breakdownDailyBills">0.00</span></p>
                                <p>Suggested to save: Â£<span id="breakdownSuggestedSave">0.00</span></p>
                                <p>Safe to spend today: Â£<span id="breakdownSafeToSpend">0.00</span></p>
                            </div>
                            <div id="monthlyOverviewSection" class="monthly-overview-section">
                                <h2>Monthly Overview</h2>
                                <p class="monthly-overview-bills">Total Bills this month: Â£<span id="monthlyOverviewBills">0.00</span></p>
                                <p class="monthly-overview-spending">Total Spending this month: Â£<span id="monthlyOverviewSpending">0.00</span></p>
                            </div>
                            <div id="summary" class="dashboard-summary">
                                <h2>Overview</h2>
                                <p>Total Income: Â£<span id="totalIncome">0.00</span></p>
                                <p>Total Expenses: Â£<span id="totalExpenses">0.00</span></p>
                                <p><strong>Net balance: Â£<span id="netBalance">0.00</span></strong></p>
                            </div>
                            <div id="recurringBillsSection" class="recurring-bills">
                                <h2>Recurring bills</h2>
                                <p>Total: Â£<span id="recurringBillsTotal">0.00</span></p>
                                <ul id="recurringBillsList" class="recurring-bills-list"></ul>
                            </div>
                            <div id="savingGoalsSection" class="saving-goals">
                                <h2>Saving goals</h2>
                                <ul id="savingGoalsList" class="saving-goals-list"></ul>
                            </div>
                        </div>

                        
                        <h2>Add expense</h2>
                        <p id="total">Total: Â£0.00</p>
                        <form id="expense-form">
                            <label>
                                Amount:
                                <input type="number" id="amount" placeholder="0.00" required>
                            </label>
                        
                            <label>
                                Date:
                                <input type="date" id="date">
                            </label>

                            <label>
                                Notes:
                                <input type="text" id="notes" placeholder="e.g. Groceries">
                                <p id="emptyState" class="emptyState">
                                    No expenses yet. Add your first one!
                                </p>
                            </label>
                        
                            <select id="category">
                                <option value="">select category</option>
                                <option value="Food">Food</option>
                                <option value="transport">Transport</option>
                                <option value="housing">housing</option>
                                <option value="Bills">Bills</option>
                                <option value="Other">Other</option>
                            </select>

                            <label for="expenseType">Type</label>
                            <select id="expenseType" aria-label="Expense type">
                                <option value="spending" selected>Spending (discretionary)</option>
                                <option value="bill">Bill (fixed/recurring)</option>
                            </select>
                            <div id="billScheduleWrap" class="bill-schedule-wrap hidden" aria-hidden="true">
                                <label for="billSchedule">Bill schedule</label>
                                <select id="billSchedule" aria-label="Bill schedule">
                                    <option value="single" selected>Single time</option>
                                    <option value="recurring">Recurring</option>
                                </select>
                            </div>

                            <button type="submit">Add expense</button>
                            <p id="expenseFormError" class="expense-form-error" role="alert" aria-live="polite"></p>
                        </form>
                    </div>
                    
                    <!-- Page 2: History (View All) -->
                    <div class="page" id="historyPage">
                        <h2>Expense History</h2>
                        
                        <!-- Month Filter -->
                        <div class="month-filter">
                            <label for="monthFilter">Month</label>
                            <select id="monthFilter">
                                <option value="current">This month</option>
                                <option value="all">All months</option>
                            </select>
                        </div>
                        
                        <!-- History Toggles -->
                        <div class="history-toggle-row">
                            <button id="toggleMonthlyChartBtn" class="history-toggle-btn">Hide monthly chart</button>
                            <button id="toggleCategoryChartBtn" class="history-toggle-btn">Hide category chart</button>
                        </div>
                        
                        <!-- Chart Section (visible by default so charts show) -->
                        <div class="chart-container chart-visible" id="monthlyChartSection">
                            <h3>Monthly Expenses Chart</h3>
                            <canvas id="MonthlyChart"></canvas>
                        </div>
                        
                        <!-- Action Buttons -->
                        <div class="action-buttons">
                            <button id="exportbtn" class="export-btn" type="button">
                                Export CSV
                            </button>
                            <button id="clearAllBtn" class="danger">
                                Clear all expenses
                            </button>
                        </div>
                        
                        <!-- Expenses List -->
                        <div class="history-tools">
                            <button id="toggleExpenseListBtn" class="history-toggle-btn">Hide expenses</button>
                            <input id="expenseSearch" type="text" placeholder="Search notes, category, date..." />
                        </div>

                        <h3>This Month</h3>
                        <p id="historyMonthlyTotal">Â£0.00</p>

                        <h4>By Category</h4>
                        <ul id="categorySummary"></ul>

                        <!-- Category Chart (visible by default) -->
                        <div class="chart-container chart-visible" id="categoryChartSection">
                            <h3>Spending by Category</h3>
                            <canvas id="ExpensesChart"></canvas>
                        </div>
                        
                        <h3>Expenses</h3>
                        <ul id="expense-list" class="expense-list-visible"></ul>
                    </div>

                    <!-- Page 3: Hourly Tracker -->
                    <div class="page" id="hourlyPage">
                        <h2>Hourly Tracker</h2>
                        <div class="hourly-rate-setting">
                            <label for="hourlyRateInput">Hourly rate (Â£)</label>
                            <input type="number" id="hourlyRateInput" min="0" step="0.01" placeholder="0.00" />
                            <label for="savingsPercentInput">Auto-save percentage (%)</label>
                            <input type="number" id="savingsPercentInput" min="0" max="100" step="0.5" placeholder="20" aria-label="Auto-save percentage" />
                            <button type="button" id="savePreferenceBtn" class="save-preference-btn">Save preference</button>
                            <span id="hourlyRateMsg" class="hourly-msg" aria-live="polite"></span>
                        </div>
                        <div class="hourly-tracker-actions">
                            <button type="button" id="startWorkBtn" class="start-work-btn">Start work</button>
                        </div>
                        <div id="breakEntryWrap" class="break-entry-wrap" style="display: none;" aria-live="polite">
                            <p class="break-entry-label">How long were you on break?</p>
                            <div class="break-entry-inputs">
                                <input type="number" id="breakDurationInput" min="0" step="0.5" value="0" placeholder="0" aria-label="Break duration" />
                                <select id="breakUnitSelect" aria-label="Break unit">
                                    <option value="minutes">minutes</option>
                                    <option value="hours">hours</option>
                                </select>
                            </div>
                            <div class="break-entry-buttons">
                                <button type="button" id="confirmSessionBtn" class="confirm-session-btn">Save session</button>
                                <button type="button" id="cancelBreakEntryBtn" class="cancel-break-btn">Cancel</button>
                            </div>
                        </div>
                        <div id="hourlyTimerWrap" class="hourly-timer-wrap" aria-live="polite">
                            <span id="hourlyTimerDisplay" class="hourly-timer-display">00:00:00</span>
                        </div>
                        <p id="startWorkMsg" class="hourly-msg" role="status"></p>
                        <p id="todayEarningDisplay" class="today-earning">Today: Â£0.00</p>
                        <p id="weekEarningDisplay" class="week-earning">This week: Â£0.00</p>
                        <p id="pacingDisplay" class="pacing-projection">If you keep this pace: Â£0.00 today, Â£0.00 week, Â£0.00 month</p>
                        <div id="smartSavingsBox" class="smart-savings-box" aria-live="polite">
                            <h3 class="smart-savings-title">Smart savings</h3>
                            <p id="suggestedSavingsDisplay" class="suggested-savings-text">Suggested to save today Â£0.00</p>
                            <p id="safeToSpendDisplay" class="safe-to-spend-text">Safe to spend today Â£0.00</p>
                            <p id="safeToSpendSmartMessage" class="smart-savings-message safe-to-spend-message" role="status" aria-live="polite"></p>
                            <p id="smartSavingsMessage" class="smart-savings-message" role="status"></p>
                        </div>
                        <div id="workSessionsSection" class="work-sessions-section">
                            <h3>Past sessions</h3>
                            <ul id="workSessionsList" class="work-sessions-list"></ul>
                        </div>
                    </div>

                    <!-- Page 4: Stocks -->
                    <div class="page" id="stocksPage">
                        <h2>Portfolio</h2>
                        <form id="stockForm" class="stocks-form">
                            <label for="stockTicker">Ticker</label>
                            <input type="text" id="stockTicker" placeholder="e.g. AAPL" required maxlength="12" autocomplete="off" />
                            <label for="stockShares">Shares</label>
                            <input type="number" id="stockShares" min="0" step="any" placeholder="0" required />
                            <label for="stockAvgPrice">Avg price (Â£)</label>
                            <input type="number" id="stockAvgPrice" min="0" step="0.01" placeholder="0.00" required />
                            <button type="submit" class="btn-primary stocks-submit">Add holding</button>
                        </form>
                        <p id="stockFormMsg" class="stocks-msg" role="status" aria-live="polite"></p>
                        <div class="portfolio-section">
                            <h3>Your holdings</h3>
                            <ul id="portfolioList" class="portfolio-list"></ul>
                            <p id="portfolioEmpty" class="portfolio-empty">No holdings yet. Add a position above.</p>
                        </div>
                    </div>

                    <!-- Page 5: Mortgage Tracker -->
                    <div class="page" id="mortgagePage">
                        <h2>Mortgage Tracker</h2>
                        <form id="mortgageForm" class="mortgage-form">
                            <label for="mortgagePropertyName">Property name</label>
                            <input type="text" id="mortgagePropertyName" placeholder="e.g. Home" required />
                            <label for="mortgageLoanAmount">Loan amount (Â£)</label>
                            <input type="number" id="mortgageLoanAmount" min="0" step="0.01" placeholder="0.00" required />
                            <label for="mortgageInterestRate">Interest rate (%)</label>
                            <input type="number" id="mortgageInterestRate" min="0" step="0.01" placeholder="0.00" required />
                            <label for="mortgageTermYears">Term (years)</label>
                            <input type="number" id="mortgageTermYears" min="1" step="1" placeholder="25" required />
                            <label for="mortgageMonthlyPayment">Monthly payment (Â£)</label>
                            <input type="number" id="mortgageMonthlyPayment" min="0" step="0.01" placeholder="0.00" required />
                            <label for="mortgageRemainingBalance">Remaining balance (Â£)</label>
                            <input type="number" id="mortgageRemainingBalance" min="0" step="0.01" placeholder="0.00" required />
                            <label for="mortgageStartDate">Start date</label>
                            <input type="date" id="mortgageStartDate" required />
                            <button type="submit" class="btn-primary mortgage-submit">Add mortgage</button>
                        </form>
                        <p id="mortgageFormMsg" class="stocks-msg" role="status" aria-live="polite"></p>
                        <div class="mortgage-list-section">
                            <h3>Your mortgages</h3>
                            <ul id="mortgageList" class="mortgage-list"></ul>
                            <p id="mortgageListEmpty" class="portfolio-empty">No mortgages yet. Add one above.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Onboarding Modal -->
        <div id="onboardingModal" class="modal onboarding-modal">
            <div class="modal-content onboarding-content">
                <div class="onboarding-slide active" data-slide="1">
                    <div class="onboarding-icon">ðŸ’°</div>
                    <h2>Welcome to Winner</h2>
                    <p>Track your expenses effortlessly and stay on top of your finances.</p>
                </div>
                <div class="onboarding-slide" data-slide="2">
                    <div class="onboarding-icon">âž•</div>
                    <h2>Add Expenses Easily</h2>
                    <p>Use the "Add Expense" tab to quickly record your spending with categories and notes.</p>
                </div>
                <div class="onboarding-slide" data-slide="3">
                    <div class="onboarding-icon">ðŸ“Š</div>
                    <h2>View Your History</h2>
                    <p>Check the "History" tab to see all your expenses, charts, and export your data.</p>
                </div>
                <div class="onboarding-slide" data-slide="4">
                    <div class="onboarding-icon">âœ¨</div>
                    <h2>You're All Set!</h2>
                    <p>Start tracking your expenses and take control of your finances today.</p>
                </div>
                <div class="onboarding-navigation">
                    <button class="onboarding-skip" id="skipOnboarding">Skip</button>
                    <div class="onboarding-dots">
                        <span class="dot active" data-dot="1"></span>
                        <span class="dot" data-dot="2"></span>
                        <span class="dot" data-dot="3"></span>
                        <span class="dot" data-dot="4"></span>
                    </div>
                    <button class="onboarding-next" id="nextOnboarding">Next</button>
                </div>
            </div>
        </div>
        
        <!-- Edit Work Session Modal (Hourly Tracker) -->
        <div id="editWorkSessionModal" class="modal" aria-labelledby="editWorkSessionTitle" aria-hidden="true">
            <div class="modal-content">
                <span class="close" id="closeEditWorkSessionModal" aria-label="Close">&times;</span>
                <h2 id="editWorkSessionTitle">Edit session</h2>
                <p class="edit-work-session-hint">Select start, finish and break â€” total worked is auto-calculated.</p>
                <div class="edit-work-session-field">
                    <label for="editWorkSessionStartInput">Start</label>
                    <input type="datetime-local" id="editWorkSessionStartInput" aria-label="Start date and time" />
                </div>
                <div class="edit-work-session-field">
                    <label for="editWorkSessionFinishInput">Finish</label>
                    <input type="datetime-local" id="editWorkSessionFinishInput" aria-label="Finish date and time" />
                </div>
                <p class="edit-work-session-break-label">Break time</p>
                <div class="edit-work-session-time-inputs">
                    <div class="edit-work-session-field">
                        <label for="editWorkSessionBreakHoursInput">Hours</label>
                        <input type="number" id="editWorkSessionBreakHoursInput" min="0" step="1" placeholder="0" aria-label="Break hours" />
                    </div>
                    <div class="edit-work-session-field">
                        <label for="editWorkSessionBreakMinutesInput">Minutes</label>
                        <input type="number" id="editWorkSessionBreakMinutesInput" min="0" max="59" step="1" placeholder="0" aria-label="Break minutes" />
                    </div>
                </div>
                <p class="edit-work-session-total-label">Total worked: <span id="editWorkSessionTotalDisplay" class="edit-work-session-total-value">0h 0m</span></p>
                <div class="edit-work-session-actions">
                    <button type="button" id="saveEditWorkSessionBtn" class="save-edit-work-session-btn">Save</button>
                    <button type="button" id="cancelEditWorkSessionBtn" class="cancel-edit-work-session-btn">Cancel</button>
                </div>
                <p id="editWorkSessionMsg" class="hourly-msg" role="status" style="margin-top: 8px;"></p>
            </div>
        </div>

        <!-- Edit Modal -->
        <div id="editModal" class="modal">
            <div class="modal-content">
                <span class="close" id="closeEditModal">&times;</span>
                <h2>Edit Expense</h2>
                <form id="edit-form">
                    <label>
                        Amount:
                        <input type="number" id="edit-amount" placeholder="0.00" required>
                    </label>
                
                    <label>
                        Date:
                        <input type="date" id="edit-date" required>
                    </label>

                    <label>
                        Notes:
                        <input type="text" id="edit-notes" placeholder="e.g. Groceries" required>
                    </label>
                
                    <select id="edit-category" required>
                        <option value="">select category</option>
                        <option value="Food">Food</option>
                        <option value="transport">Transport</option>
                        <option value="housing">housing</option>
                        <option value="Bills">Bills</option>
                        <option value="Other">Other</option>
                    </select>
                    <label for="edit-type">Type</label>
                    <select id="edit-type" aria-label="Expense type">
                        <option value="spending">Spending (discretionary)</option>
                        <option value="bill">Bill (fixed/recurring)</option>
                    </select>
                    <div id="editBillScheduleWrap" class="bill-schedule-wrap">
                        <label for="edit-billSchedule">Bill schedule</label>
                        <select id="edit-billSchedule" aria-label="Bill schedule">
                            <option value="single">Single time</option>
                            <option value="recurring">Recurring</option>
                        </select>
                    </div>
                    <button type="button" id="saveEditBtn">Save Changes</button>
                </form>
            </div>
        </div>

        <!-- Edit Stock Modal -->
        <div id="editStockModal" class="modal" aria-labelledby="editStockModalTitle" aria-hidden="true">
            <div class="modal-content">
                <span class="close" id="closeEditStockModal" aria-label="Close">&times;</span>
                <h2 id="editStockModalTitle">Edit holding</h2>
                <form id="edit-stock-form">
                    <label for="editStockTicker">Ticker</label>
                    <input type="text" id="editStockTicker" placeholder="e.g. AAPL" required maxlength="12" autocomplete="off" />
                    <label for="editStockShares">Shares</label>
                    <input type="number" id="editStockShares" min="0" step="any" placeholder="0" required />
                    <label for="editStockAvgPrice">Avg price (Â£)</label>
                    <input type="number" id="editStockAvgPrice" min="0" step="0.01" placeholder="0.00" required />
                    <div class="edit-stock-actions">
                        <button type="button" id="saveEditStockBtn" class="btn-primary">Save</button>
                        <button type="button" id="cancelEditStockBtn">Cancel</button>
                    </div>
                </form>
                <p id="editStockMsg" class="stocks-msg" role="status" aria-live="polite"></p>
            </div>
        </div>
        
        <script src="script.js"></script>
    </body>
</html> 
